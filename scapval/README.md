# SCAPVal
> A command line tool to validate SCAP content.

## Overview:
Security Content Automation Protocol Validator (SCAPVal) is a Java Command Line Application that provides information
about whether SCAP content conforms to conventions and recommendations outlined in NIST Special Publication 800-126,
The Technical Specification for the Security Content Automation Protocol (SCAP). With support for SCAP 1.1, 1.2, and 1.3

SCAPVal validates the data stream according to one of the use cases for an SCAP-validated tool listed in 800-126,
namely Compliance Checking, Vulnerability Scanning, Inventory Scanning, and Other.
Checks components and data streams against appropriate schemas. Uses Schematron to perform additional checks within and across component data streams.

Stand alone XCCDF, OVAL, and OCIL files, separate from SCAP can also be validated using -componentfile.

SCAPVal produces validation results in a report that conveys all error and warning conditions detected; results are output in both XML and HTML formats.

For a listing of the SCAP requirements this tool adheres to, refer to the files in the /requirements directory.

Requires Java Runtime Environment (JRE) 1.8 or higher.
If the JAVA_HOME variable is set then the JRE which is at that location will be used. Otherwise the JRE available on the path is used.

A .bat batch file is provided for usage in Windows

## Example Usage:
For a 1.3 Source Data Stream:
    "scapval.bat -scapversion 1.3 -file source_data_stream_collection_sample.xml"

For a 1.3 Result Data Stream:
    "scapval.bat -scapversion 1.3 -resultfile arf-result.xml"

For a 1.2 Source Data Stream with resolution of remote resources and verbose output:
     "scapval.bat -scapversion 1.2 -file datastream-12.xml -online -debug"

Results for the above are generated by default and provided in validation-report.html and validation-result.xml

Usage Details:
----
The tool's command line interface can be run using the following arguments:

usage: scapval <options>
 -combinedoutput <arg>   Creates an optional file for reference containing
                         any combined remote resources processed by
                         SCAPVal and any -sourceds Data Stream specified.
                         This file is a copy of the final content SCAPVal
                         validates against.
 -componentfile <arg>    Validate an individual component file. Currently
                         XCCDF/OVAL/OCIL is supported
 -debug                  Enable verbose output
 -dir <arg>              Directory of individual component SCAP files.
                         Provide if validating SCAP 1.1 source files only
 -file <arg>             SCAP Source XML file (SCAP 1.2, 1.3) or ZIP file
                         (SCAP 1.1). Only provide if validating source
                         files
 -h,--help               Display the available cli arguments
 -maxsize <arg>          Overwrites the default max download size for
                         remote references (specified in MiB)
 -online                 Enable download of latest dictionaries and remote
                         resolution of some components
 -quiet                  Silence console output
 -resultdir <arg>        Directory of individual component SCAP result
                         files. Provide if validating SCAP 1.1 result
                         files only
 -resultfile <arg>       SCAP result XML file (SCAP 1.2, 1.3) or ZIP file
                         (SCAP 1.1). Only provide if validating result
                         files
 -scapversion <arg>      The SCAP version to validate. 1.1, 1.2, and 1.3
                         are supported
 -sourceds <arg>         Specifies the location of the source data stream
                         to include with results. For SCAP 1.1 it will be
                         included in the 1.1 Data Stream, for SCAP 1.2 and
                         1.3 it will included in ARF Report
 -usecase <arg>          required for .ZIP files or -directory of
                         individual component SCAP files. One of -file or
                         -dir is required option, the SCAP use case, one
                         of [[CONFIGURATION, VULNERABILITY_XCCDF_OVAL,
                         VULNERABILITY_OVAL, VULNERABILITY, OVAL_ONLY,
                         OTHER, SYSTEM_INVENTORY, INVENTORY]] (use
                         OVAL_ONLY for SCAP 1.1, and OTHER for SCAP
                         1.2/1.3)
 -valreportfile <FILE>   The validation HTML report file location
                         (default: validation-report.html)
 -valresultfile <FILE>   The validation result file location (default:
                         validation-result.xml)
 -version                Display the version of the tool

Use Notes:
----
Once the validation is completed, two result files will be created:

  validation-result.xml - An XML file containing the set of requirements used
      for validation, and the status of each requirement.
  validation-report.html - A human-readable report based on the validations
      results.

If remote resources are defined in content, SCAPVal will attempt to resolve them when when ran with the -online parameter.
The remote content will be downloaded and automatically combined with the local content before validation begins.
When validating result content and the source content is specified with -source_ds, SCAPVal will combine the two before validation begins.
SCAPVal will provide a combined content file for reference when using the -combinedcontent parameter to specify an output file location.

Feedback:
---------
Please send tool defects reports, enhancement requests, and any other related
comments by email to scap@nist.gov.

Changelog:
----------
Todo