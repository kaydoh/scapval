<?xml version="1.0" encoding="UTF-8"?>
<template template="configuration-use-case-base.xml" xmlns="http://csrc.nist.gov/ns/decima/template/1.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:ds="http://scap.nist.gov/schema/data-stream/0.2"
    xmlns:xccdf="http://checklists.nist.gov/xccdf/1.1"
    xsi:schemaLocation="http://csrc.nist.gov/ns/decima/template/1.0 http://csrc.nist.gov/schema/decima/template/decima-template-1.0.xsd">
    
    <modify-attribute xpath="/ds:data-stream/@use-case" value="VULNERABILITY_XCCDF_OVAL" />

    <replace xpath="//*:Rule[@id='test_rule1']" >
        <Rule id="test_rule1" selected="false" weight="10.0" xmlns="http://checklists.nist.gov/xccdf/1.1">
            <title>Test Title for Rule 1</title>
            <description>Test Description for Rule 1</description>
            <ident system="http://cve.mitre.org">CVE-1999-0002</ident>
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                <check-content-ref href="minimal-oval.xml" name="oval:gov.nist.test.vulnerability:def:1" />
            </check>
        </Rule>
    </replace>
    <insert-child xpath="//*:data-stream">
      <!-- ================================================================================ -->
      <!-- =============================  OVAL VULNERABILITY  ============================= -->
      <!-- ================================================================================ -->
      <ds:check-system-content content-type="OVAL_VULNERABILITY" id="minimal-oval.xml">
        <oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:ind-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:win-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows http://oval.mitre.org/language/download/schema/version5.3/ovaldefinition/complete/windows-definitions-schema.xsd       http://oval.mitre.org/XMLSchema/oval-definitions-5#independent http://oval.mitre.org/language/download/schema/version5.3/ovaldefinition/complete/independent-definitions-schema.xsd       http://oval.mitre.org/XMLSchema/oval-definitions-5 http://oval.mitre.org/language/download/schema/version5.3/ovaldefinition/complete/oval-definitions-schema.xsd       http://oval.mitre.org/XMLSchema/oval-common-5 http://oval.mitre.org/language/download/schema/version5.3/ovaldefinition/complete/oval-common-schema.xsd">
            <generator>
                <oval:schema_version>5.3</oval:schema_version>
                <oval:timestamp>2009-12-01T00:00:00</oval:timestamp>
            </generator>
            <definitions>
                <definition id="oval:gov.nist.test.vulnerability:def:1" version="1" class="vulnerability">
                    <metadata>
                        <title>Test Title</title>
                        <affected family="windows">
                            <platform>Microsoft Windows XP</platform>
                        </affected>
                        <description>Test Description</description>
                        <oval-def:reference source="http://cve.mitre.org" ref_id="CVE-1999-0002" />
                    </metadata>
                </definition>
            </definitions>
        </oval_definitions>
      </ds:check-system-content>
    </insert-child>
    <delete xpath="//*:data-stream//*:check-system-content[@content-type='OVAL_COMPLIANCE']" />
</template>